= 编码风格指南

编码风格指南文件鼓励贡献者提交代码更改，通过维护代码质量和匹配特定项目的现有编码风格。本文档指导您按照 Neutralinojs 内部编码风格编写 C++ 或 JavaScript 代码。

遵循以下要点可以使拉取请求合并过程更加高效。

[[programming-best-practices]]
== 编程最佳实践

首先，确保您的代码更改遵循以下与语言无关的最佳实践：

* Neutralinojs 代码库采用过程式和函数式混合编码风格，因此避免添加类和面向对象编程（OOP）概念。不过，可以使用基于类的库，但请确保不要从 Neutralinojs 内部过程暴露这些类。
* 即使开发需求较为复杂，也要保持源代码的简洁性。link:https://levelup.gitconnected.com/5-programming-principles-that-help-you-to-write-better-code-5d96197725cc?sk=750ce3340204c82c7ae053dfa8337a85[本文] 进一步解释了您需要了解的编程原则。
* 我们已经稳定了 Neutralinojs 代码库结构，并且目前没有计划通过添加新模块来扩展它。换句话说，请尽量在不改变现有代码结构的情况下实现代码更改。如果您的代码建议需要扩展代码结构，请先讨论。
* 尽量使新 API 和功能与现有实现保持一致。
* 我们决定不在 Neutralinojs API 中暴露任何操作系统特定的功能，以确保框架在所有操作系统上的一致性。因此，请确保您的新功能可以在所有支持的操作系统上运行。
* 为新功能编写测试，并更新变更日志文件。
* 只有在需要进一步解释时才添加注释。
* 为每个代码元素使用易于理解的标识符，并遵循代码库中现有的命名约定。
* 使用四个空格进行缩进，而不是制表符或两个空格。查看现有的源文件，并在新源文件中使用相同的格式。

[[c-code-style-guide]]
== C++ 编码风格指南

我们仍在编写完整的 C++ 编码风格指南。目前，请确保遵循以下要点以提交 C++ 代码：

* 我们不使用 C++ 异常。使用布尔值来标识失败。例如，我们使用以下结构体进行文件读取操作：

[source,cpp]
----
struct FileReaderResult {
    bool hasError = false;
    string error;
    string data;
};
----

* 我们更倾向于使用单行注释（即 `// comment`），而不是多行注释。
* 对于复杂数据类型，使用引用传递；对于原子类型，使用值传递。此外，如果参数在过程中不会改变，请正确使用 `const` 关键字。例如，查看以下函数定义：

[source,cpp]
----
fs::FileReaderResult readFile(const string &filename);
----

* 避免混合使用旧的 C 风格语法和现代 C++ 语法。
* 使用双下划线前缀（`__`）声明仅在模块内使用的函数，如下所示：

[source,cpp]
----
void __registerAllowList() {
    // 实现
}
----

* 使用 getter 和 setter 函数，而不是共享全局变量（使用 `extern` 定义）。

[[javascript-code-style-guide]]
== JavaScript 编码风格指南

* 使用 ES6 JavaScript 语法，避免使用遗留语言语法。
* 对于复杂的字符串构建，使用模板字面量；对于简单的拼接，使用 + 运算符。
* 使用 async/await 语法，而不是 then/catch 语法进行异步操作。
* 避免使用过于新的 JavaScript API 和语言特性，因为我们需要支持较旧的 Node.js 和浏览器版本。不过，如果旧的 JavaScript 特性会影响可读性，请三思而后行。
* 函数参数不要超过三个，如果需要更多参数，请使用 JSON 对象以提高可读性。
* 如果您正在处理 TypeScript 代码，请始终尽量使用有意义的数据类型，而不是 `any` 或 `unknown` 这些宽泛的数据类型。
