= 安全

安全通常是软件系统中隐藏的一层，但它和其他元素一样，是高质量软件系统中至关重要的部分。应用安全是用户的权利，也是开发者防止各种数字攻击的责任。此外，由于计算机用户数量的不断增加，安全优先的设计已成为现代软件系统的强制性设计原则。

我们采用以下策略来加强框架的安全层。

[[port-security-and-authentication]]
== 端口安全与认证

一旦你研究了 xref:contributing/architecture.adoc[Neutralinojs 架构]，你会注意到框架前端通过基于 WebSocket 的网络端口与框架核心进行通信。了解操作系统内部的开发人员会认为，由于基于本地端口的 IPC，Neutralinojs 框架存在漏洞。

我们可以这样理解。网络无疑是脆弱的，但网络安全策略使网络对每个计算机用户都安全——这就是我们今天信任互联网的方式。同样，Neutralinojs 使用一次性令牌（OTT）策略来防止可能的端口扫描攻击。

以下是 Neutralinojs 本地端口的安全方式：

* Neutralinojs 框架的认证模块在初始化过程中生成 OTT，并将 OTT 的一部分保存为 WebSocket 客户端的连接令牌（CT）。
* 当用户加载客户端库脚本时，框架仅发送一次 OTT。
* 客户端库将 OTT 存储在本地存储中以供后续使用——框架不会再向前端发送 OTT。根据当前应用程序模式，客户端库将 OTT 存储在 webview 或网络浏览器中。
* 客户端库使用 CT 与框架建立 WebSocket 连接。
* OTT 用于验证来自 WebSocket 客户端（包括客户端库）的每一个原生 API 函数调用。
* 框架会阻止在窗口、浏览器和 Chrome 模式下从远程 URL 建立 WebSocket 连接。

通过恶意网页（本地）或程序执行任意 API 函数需要满足以下条件：

* 特定的恶意组件需要在原始应用程序从框架核心获取 OTT 之前捕获 OTT。这种攻击策略并不可行，因为应用程序启动速度很快，且没有更快的方法可以访问操作系统级别的进程状态。即使有人设法检测到应用程序启动，原始应用程序也会在恶意程序之前请求 OTT（框架仅发送一次 OTT）。另一方面，恶意程序不需要 Neutralinojs 就可以破坏你的计算机系统，因此请使用你信任的程序。
* 由于类似 CORS 的安全策略，现代网络浏览器无法通过远程页面发起 OTT 请求过程。此外，由于严格的应用程序安全策略，我们甚至没有为远程页面启用原生 API。
* 如果有方法（目前还没有经过验证的方法）破解 OTT，原生 API 访问控制将保护用户的计算机。

[[native-api-access-control-and-authorization]]
== 原生API访问控制和授权

OTT 策略通过防止无效/易受攻击的客户端连接，为原生 API 访问提供认证。OTT 授予对原生 API 的访问权限，但它并不授予对一切的访问权限。大多数现代流行的应用程序运行时在没有适当访问控制的情况下提供对一切的访问权限。在 Neutralinojs 的原生 API 模型中，开发者需要明确列出他们需要的 API，以实现更好的安全性。

开发者可以通过原生允许列表或阻止列表功能定义 API 权限需求。Neutralinojs 的原生 API 权限系统通过使用预定义的权限矩阵验证传入请求，提供授权支持。

请查看以下认证/授权图以获取更多详细信息：

image:https://neutralino.js.org/assets/images/neutralinojs-security-b9e4b44bbfc16e3e354e6832a120948a.png[]]

此外，Neutralinojs 扩展也通过标准输入流安全地接收 WebSocket 认证详细信息（OTT、CT 和端口），因此恶意程序无法通过扫描你的进程列表来获取连接密钥。

阅读我们的 link:https://github.com/neutralinojs/neutralinojs/security/policy[安全策略]，了解如何处理与框架相关的安全问题。
